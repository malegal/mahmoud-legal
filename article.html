<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جاري تحميل الدراسة... | محمود عبد الحميد</title>
    
    <!-- المكتبات الخارجية -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    
    <!-- مكتبة تحويل Markdown إلى HTML (ضرورية جداً لفتح المقالات) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        :root {
            --primary-dark: #020617; 
            --gold-gradient: linear-gradient(135deg, #bf953f 0%, #fcf6ba 25%, #b38728 50%, #fbf5b7 75%, #aa771c 100%);
            --gold-solid: #bf953f;
            --gold-glow: rgba(191, 149, 63, 0.4);
        }
        
        body { 
            font-family: 'Tajawal', sans-serif; 
            background-color: var(--primary-dark); 
            color: #ffffff;
            line-height: 1.8;
        }

        .serif-font { font-family: 'Amiri', serif; }
        .gold-text { background: var(--gold-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }

        /* تنسيقات الهيدر */
        .header-glass {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 2px solid #bf953f;
        }

        /* تنسيقات قراءة المقال (أهم جزء) */
        .article-body {
            font-size: 1.35rem; /* حجم خط مريح للقراءة */
            text-align: justify;
            color: #e2e8f0;
        }
        
        /* عناوين داخل المقال بوزن ملكي */
        .article-body h1, .article-body h2, .article-body h3 {
            font-family: 'Amiri', serif;
            color: var(--gold-solid);
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }
        .article-body h1 { font-size: 2.8rem; border-bottom: 1px solid rgba(191, 149, 63, 0.3); padding-bottom: 10px; }
        .article-body h2 { font-size: 2.2rem; }
        .article-body h3 { font-size: 1.8rem; }
        
        /* الاقتباسات القانونية */
        .article-body blockquote {
            border-right: 5px solid var(--gold-solid);
            background: rgba(191, 149, 63, 0.05);
            padding: 1.5rem 2rem;
            margin: 2.5rem 0;
            border-radius: 0 15px 15px 0;
            font-style: italic;
            font-family: 'Amiri', serif;
            font-size: 1.5rem;
        }

        /* الأيقونات العائمة */
        .contact-floating { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 15px; z-index: 1000; }
        .whatsapp-float, .call-float { width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transition: 0.3s; color: white; }
        .whatsapp-float { background: #25d366; } .call-float { background: #0077b6; }
        .whatsapp-float:hover, .call-float:hover { transform: scale(1.1); }

        /* الفوتر الذهبي الملكي */
        .footer-social-icon {
            width: 45px; height: 45px; border-radius: 50%; border: 1px solid var(--gold-solid);
            display: flex; align-items: center; justify-content: center; transition: 0.3s;
            background: transparent; color: var(--gold-solid);
        }
        .footer-social-icon:hover { 
            background: var(--gold-gradient); color: #000; 
            box-shadow: 0 0 15px var(--gold-solid); transform: translateY(-3px);
        }

        /* كروت المقالات المقترحة */
        .suggested-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(191,149,63,0.1);
            border-radius: 20px;
            padding: 1.5rem;
            transition: 0.4s;
            height: 100%;
        }
        .suggested-card:hover { border-color: var(--gold-solid); background: rgba(191,149,63,0.05); transform: translateY(-5px); }
    </style>
</head>
<body>

<!-- الأزرار العائمة -->
<div class="contact-floating">
    <a href="https://wa.me/201101076000" target="_blank" class="whatsapp-float"><i class="fab fa-whatsapp"></i></a>
    <a href="tel:+201101076000" class="call-float"><i class="fas fa-phone-alt"></i></a>
</div>

<!-- الهيدر الموحد -->
<header class="fixed w-full z-[100] header-glass py-3 px-6">
    <nav class="max-w-7xl mx-auto flex justify-between items-center">
        <div class="flex items-center gap-3">
            <img src="logo.png" alt="Logo" class="w-14 h-14 object-contain">
            <div class="flex flex-col leading-tight">
                <h1 class="font-bold gold-text serif-font text-xl">محمود عبد الحميد</h1>
                <p class="text-gray-400 text-[10px] tracking-widest uppercase">Law Firm</p>
            </div>
        </div>
        <a href="blog.html" class="text-gold-solid font-bold text-sm flex items-center gap-2 hover:gap-4 transition-all">
            <i class="fas fa-arrow-right"></i> العودة للمدونة
        </a>
    </nav>
</header>

<!-- محتوى المقال -->
<main class="pt-40 pb-20 px-6 max-w-4xl mx-auto">
    <!-- عنوان المقال -->
    <header class="text-center mb-16">
        <span class="gold-text uppercase tracking-[0.3em] font-black text-xs mb-3 block">Legal Blog Study</span>
        <h1 id="article-title" class="serif-font text-4xl md:text-6xl font-black leading-tight text-white mb-6">
            <!-- سيظهر العنوان هنا -->
        </h1>
        <div class="w-24 h-1 bg-gold-solid mx-auto rounded-full"></div>
    </header>

    <!-- مكان ظهور نص المقال -->
    <article id="article-content" class="article-body">
        <!-- أنيميشن التحميل -->
        <div class="text-center py-20">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-gold-solid mb-4"></div>
            <p class="text-gold-solid italic">جاري مراجعة الدراسة القانونية...</p>
        </div>
    </article>

    <!-- قسم المقالات المقترحة -->
    <section class="mt-32 pt-16 border-t border-white/10">
        <h3 class="serif-font text-3xl text-gold-solid mb-10 flex items-center gap-4">
            <i class="fas fa-bookmark text-xl"></i> دراسات قانونية مقترحة
        </h3>
        <div id="suggested-posts" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- المقالات المقترحة تظهر هنا -->
        </div>
    </section>
</main>

<!-- الفوتر الملكي -->
<footer class="pt-16 pb-8 border-t border-gold-solid/30 bg-[#000000] text-center">
    <div class="max-w-7xl mx-auto px-6">
        <img src="logo.png" class="w-20 h-20 mx-auto mb-6 opacity-80">
        <h2 class="text-2xl font-black gold-text serif-font mb-4">مؤسسة محمود عبد الحميد للمحاماة</h2>
        
        <div class="flex justify-center gap-6 mb-12">
            <a href="https://www.facebook.com/malegal" target="_blank" class="footer-social-icon"><i class="fab fa-facebook-f"></i></a>
            <a href="https://x.com/mahmoud_a_hamyd" target="_blank" class="footer-social-icon"><i class="fab fa-twitter"></i></a>
            <a href="https://www.linkedin.com/in/mahmoud-abdel-hamid-0a4664374" target="_blank" class="footer-social-icon"><i class="fab fa-linkedin-in"></i></a>
            <a href="mailto:ma.law.firm@outlook.com" class="footer-social-icon"><i class="fas fa-envelope"></i></a>
        </div>
        
        <p class="text-gray-600 text-[10px] tracking-widest uppercase border-t border-gold-solid/10 pt-8">
            جميع الحقوق محفوظة © ٢٠٢٦ - التميز في الاستشارات القانونية
        </p>
    </div>
</footer>

<script>
    async function loadArticleData() {
        const urlParams = new URLSearchParams(window.location.search);
        const slug = urlParams.get('slug');
        if(!slug) { window.location.href = 'blog.html'; return; }

        const owner = "malegal";
        const repo = "mahmoud-legal";
        const rawUrl = `https://raw.githubusercontent.com/${owner}/${repo}/main/blog/articles/${slug}.md`;

        try {
            // 1. جلب محتوى المقال
            const response = await fetch(rawUrl);
            if(!response.ok) throw new Error("File not found");
            const markdown = await response.text();

            // 2. تحديث العنوان والمحتوى
            const title = decodeURIComponent(slug.replace(/-/g, ' '));
            document.title = title + " | مدونة محمود عبد الحميد";
            document.getElementById('article-title').innerText = title;
            
            // تحويل الـ Markdown إلى HTML نظيف
            document.getElementById('article-content').innerHTML = marked.parse(markdown);

            // 3. جلب مقالات مقترحة (عشوائية من نفس المجلد)
            loadSuggestions(owner, repo, slug);

        } catch (error) {
            document.getElementById('article-content').innerHTML = `
                <div class="text-center py-20">
                    <i class="fas fa-exclamation-triangle text-5xl text-gold-solid mb-4"></i>
                    <h2 class="text-2xl font-bold">عذراً، لم نتمكن من العثور على هذه الدراسة</h2>
                    <a href="blog.html" class="text-gold-solid underline mt-4 block">العودة للمدونة</a>
                </div>`;
        }
    }

    async function loadSuggestions(owner, repo, currentSlug) {
        try {
            const listRes = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/blog/articles`);
            const allFiles = await listRes.json();
            
            // استبعاد المقال الحالي واختيار 2 آخرين
            const suggestions = allFiles
                .filter(f => !f.name.includes(currentSlug) && f.name.endsWith('.md'))
                .sort(() => 0.5 - Math.random()) // ترتيب عشوائي
                .slice(0, 2);

            const sugContainer = document.getElementById('suggested-posts');
            suggestions.forEach(file => {
                const sSlug = file.name.replace('.md', '');
                const sTitle = decodeURIComponent(sSlug.replace(/-/g, ' '));
                
                sugContainer.innerHTML += `
                    <a href="article.html?slug=${sSlug}" class="suggested-card flex flex-col justify-between">
                        <h4 class="text-white font-bold text-xl serif-font mb-4 leading-relaxed line-clamp-2">${sTitle}</h4>
                        <span class="text-gold-solid text-xs font-bold uppercase">قراءة الدراسة <i class="fas fa-chevron-left mr-2"></i></span>
                    </a>`;
            });
        } catch (e) { console.error("Could not load suggestions"); }
    }

    // تشغيل الدالة عند تحميل الصفحة
    document.addEventListener('DOMContentLoaded', loadArticleData);
</script>

</body>
</html>
