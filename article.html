<!-- ... (نفس قسم الـ Head السابق مع إضافة هذا التنسيق الجديد) ... -->
<style>
    /* تنسيق صندوق "استشارة قانونية" في نهاية المقال */
    .cta-box {
        background: linear-gradient(135deg, rgba(191, 149, 63, 0.1) 0%, rgba(2, 6, 23, 1) 100%);
        border: 1px solid var(--gold-solid);
        border-radius: 2rem;
        padding: 3rem;
        text-align: center;
        margin-top: 4rem;
    }
    
    .related-card {
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(191,149,63,0.1);
        transition: all 0.3s ease;
    }
    .related-card:hover {
        border-color: var(--gold-solid);
        transform: translateY(-5px);
    }
</style>

<!-- محتوى الصفحة -->
<main class="pt-32 pb-20 px-6">
    <div class="article-container">
        <!-- (قسم الهيدر والمحتوى الأصلي هنا) -->
        <header class="mb-12">
            <h1 id="article-title" class="text-4xl md:text-6xl font-black serif-font mb-6 leading-tight gold-text"></h1>
            <!-- ... -->
        </header>

        <article id="article-content" class="markdown-content">
            <!-- المحتوى يظهر هنا -->
        </article>

        <!-- جديد: صندوق دعوة للاستشارة (CTA) -->
        <div class="cta-box reveal-on-scroll">
            <i class="fas fa-gavel text-4xl text-gold-solid mb-4"></i>
            <h3 class="text-2xl font-bold mb-4">هل تحتاج إلى استشارة قانونية دقيقة؟</h3>
            <p class="text-gray-400 mb-8">مؤسسة محمود عبد الحميد تقدم لك الدعم القانوني اللازم في مختلف التخصصات.</p>
            <div class="flex flex-wrap justify-center gap-4">
                <a href="contact.html?tab=consult" class="gold-btn px-8 py-3 rounded-full text-sm">طلب استشارة فورية</a>
                <a href="tel:+201101076000" class="border border-white/20 hover:border-gold-solid px-8 py-3 rounded-full text-sm transition">اتصال مباشر</a>
            </div>
        </div>

        <!-- جديد: قسم مقالات ذات صلة -->
        <section class="mt-20">
            <h3 class="text-2xl font-bold serif-font mb-8 flex items-center gap-4">
                <span class="w-10 h-px bg-gold-solid"></span>
                اقرأ أيضاً في مدونتنا
            </h3>
            <div id="related-posts-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- المقالات المقترحة تظهر هنا -->
            </div>
        </section>
    </div>
</main>

<script>
    // الدالة الأصلية لتحميل المقال
    async function loadArticle() {
        const params = new URLSearchParams(window.location.search);
        const slug = params.get('slug');
        
        // 1. جلب المقال الحالي
        try {
            const response = await fetch(`https://raw.githubusercontent.com/malegal/mahmoud-legal/main/blog/articles/${slug}.md`);
            const markdown = await response.text();
            document.getElementById('article-content').innerHTML = marked.parse(markdown);
            document.getElementById('article-title').textContent = decodeURIComponent(slug.replace(/-/g, ' '));
            
            // 2. بعد تحميل المقال، جلب المقالات الأخرى للـ "ذات صلة"
            loadRelatedPosts(slug);
        } catch (e) { /* معالجة الخطأ */ }
    }

    // دالة جلب المقالات ذات الصلة
    async function loadRelatedPosts(currentSlug) {
        try {
            const response = await fetch(`https://api.github.com/repos/malegal/mahmoud-legal/contents/blog/articles`);
            const files = await response.json();
            
            // تصفية المقال الحالي واختيار مقالين عشوائيين
            const otherFiles = files.filter(f => !f.name.includes(currentSlug)).slice(0, 2);
            const grid = document.getElementById('related-posts-grid');
            
            otherFiles.forEach(file => {
                const title = file.name.replace('.md', '').replace(/-/g, ' ');
                const slug = file.name.replace('.md', '');
                
                grid.innerHTML += `
                    <a href="article.html?slug=${slug}" class="related-card p-6 rounded-2xl flex flex-col gap-3">
                        <span class="text-xs text-gold-solid font-bold uppercase tracking-tighter">مقالات قانونية</span>
                        <h4 class="text-lg font-bold leading-snug">${decodeURIComponent(title)}</h4>
                        <span class="text-sm text-gray-500 mt-auto">اقرأ المزيد <i class="fas fa-chevron-left mr-2 text-[10px]"></i></span>
                    </a>
                `;
            });
        } catch (e) { console.error("خطأ في جلب المقالات المتعلقة"); }
    }

    loadArticle();
</script>
