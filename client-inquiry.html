<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="google-site-verification" content="Uqbjr1w7Q831Lo6JPFEe9_lK86Kp55P79Lwfp1j6EX8" />
    <title>استعلام القضايا | مؤسسة محمود عبد الحميد</title>
    
    <!-- Tailwind & Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700;900&family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Bootstrap للمودالات -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <!-- Supabase و SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root {
            --primary-bg: #020617;
            --gold-gradient: linear-gradient(135deg, #bf953f 0%, #fcf6ba 45%, #b38728 50%, #fbf5b7 55%, #aa771c 100%);
            --gold-solid: #bf953f;
            --glass-bg: rgba(2, 6, 23, 0.85);
            --header-height: 90px;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--primary-bg);
            background-image: radial-gradient(circle at 50% 0%, #1e293b 0%, #020617 90%);
            color: #f8fafc;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            margin: 0;
            padding-top: var(--header-height);
        }

        /* الهيدر - مطابق لصفحة تخصصاتنا */
        .header-glass {
            background: rgba(0, 0, 0, 0.95) !important;
            backdrop-filter: blur(20px);
            border-bottom: 2px solid;
            border-image: var(--gold-gradient) 1;
            box-shadow: 0 10px 30px rgba(0,0,0, 0.8);
            position: fixed;
            top: 0;
            width: 100%;
            height: var(--header-height);
            z-index: 1050;
        }
        
        .gold-text { 
            background: var(--gold-gradient); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            background-clip: text;
        }
        
        .nav-link-gold {
            background: linear-gradient(to bottom, #d4af37, #fcf6ba, #aa771c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
            transition: all 0.3s ease;
            position: relative;
        }
        .nav-link-gold:hover {
            text-shadow: 0 0 15px rgba(191, 149, 63, 0.6);
            transform: scale(1.05);
        }
        
        .serif-font {
            font-family: 'Amiri', serif;
        }
        
        .track-case-btn { 
            background: transparent; 
            border: 1px solid var(--gold-solid); 
            color: #fff; 
            font-weight: 600; 
            transition: all 0.3s ease; 
        }
        .track-case-btn:hover { 
            background: var(--gold-gradient); 
            color: #000; 
            border-color: transparent; 
        }
        
        .visit-btn {
            background: transparent;
            border: 1px solid #ffffff;
            color: #fff;
            transition: all 0.3s ease;
        }
        .visit-btn:hover {
            border-color: var(--gold-solid);
            background: rgba(191, 149, 63, 0.1);
            color: var(--gold-solid);
        }
        
        .gold-btn { 
            background: var(--gold-gradient); 
            color: #000; 
            font-weight: 800; 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            box-shadow: 0 0 15px var(--gold-glow, rgba(191,149,63,0.4));
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        .gold-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            transition: 0.5s;
            z-index: 2;
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer {
            0% { left: -100%; }
            20% { left: 100%; }
            100% { left: 100%; }
        }
        .gold-btn:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 0 30px var(--gold-glow, rgba(191,149,63,0.7)); 
        }

        /* القائمة الجانبية للموبايل */
        #mobile-menu { 
            transition: transform 0.4s cubic-bezier(0.25, 0.1, 0.25, 1); 
            transform: translateX(100%); 
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.98);
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            z-index: 110;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        #mobile-menu.active { transform: translateX(0); }

        /* المحتوى الرئيسي */
        .main-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: opacity 0.3s ease;
        }
        .main-container.hidden {
            display: none;
        }

        /* بطاقة الاستعلام - خلفية سوداء زجاجية */
        .search-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(191, 149, 63, 0.3);
            border-radius: 20px;
            padding: 50px 40px;
            width: 100%;
            max-width: 550px;
            text-align: center;
            box-shadow: 0 0 60px rgba(0,0,0,0.7);
            position: relative;
        }
        .search-card::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 4px; 
            background: var(--gold-gradient); 
        }

        .search-card h1 {
            font-family: 'Amiri', serif;
            font-size: 2.8rem;
            margin-bottom: 15px;
        }
        .search-card p {
            font-size: 1.2rem;
            margin-bottom: 40px;
        }

        .input-group-custom {
            display: flex;
            align-items: center;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(191,149,63,0.4);
            border-radius: 14px;
            margin-bottom: 25px;
            overflow: hidden;
            transition: 0.3s;
        }
        .input-group-custom:focus-within {
            border-color: var(--gold-solid);
            box-shadow: 0 0 20px rgba(191,149,63,0.3);
        }
        .fixed-prefix {
            background: rgba(0,0,0,0.4);
            color: var(--gold-solid);
            padding: 15px 18px;
            font-weight: bold;
            font-family: monospace;
            font-size: 1.3rem;
            border-left: 1px solid rgba(191,149,63,0.2);
        }
        .form-control-custom {
            background: transparent;
            border: none;
            color: white;
            padding: 15px;
            width: 100%;
            font-size: 1.2rem;
            outline: none;
            text-align: right;
        }
        .form-control-custom::placeholder { 
            color: #94a3b8;
            font-size: 1.1rem;
        }

        .btn-gold {
            background: var(--gold-gradient);
            color: #020617;
            font-weight: 900;
            border: none;
            width: 100%;
            padding: 16px;
            border-radius: 14px;
            font-size: 1.3rem;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 5px 25px rgba(191, 149, 63, 0.4);
        }
        .btn-gold:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 15px 35px rgba(191, 149, 63, 0.6); 
        }

        .footer {
            text-align: center; 
            padding: 20px; 
            color: #94a3b8; 
            font-size: 0.9rem;
            border-top: 1px solid rgba(255,255,255,0.05); 
            background: rgba(2, 6, 23, 0.95);
        }

        /* ===== مودالات بإطار ذهبي ملكي وتأثير زجاجي محسن ===== */
        .modal.fade .modal-dialog {
            transition: transform 0.4s ease-out;
            transform: translateY(-100px);
        }
        .modal.show .modal-dialog {
            transform: translateY(0);
        }

        .modal-content.glass-theme {
            background: rgba(2, 6, 23, 0.98);
            backdrop-filter: blur(15px);
            border: 3px solid var(--gold-solid);
            box-shadow: 0 10px 60px rgba(191, 149, 63, 0.5), 0 0 30px rgba(191,149,63,0.3);
            border-radius: 0 0 20px 20px;
            margin-top: var(--header-height);
            transition: box-shadow 0.3s ease;
        }
        .modal-content.glass-theme:hover {
            box-shadow: 0 15px 70px rgba(191, 149, 63, 0.7), 0 0 50px rgba(191,149,63,0.5);
        }

        #warningModal .modal-dialog {
            max-width: 400px;
        }

        .warning-content { 
            text-align: center; 
            padding: 25px 15px; 
        }
        .warning-content h3 {
            font-size: 1.8rem;
            margin: 10px 0;
        }
        .legal-box {
            background: rgba(255,255,255,0.05); 
            border: 1px solid rgba(191,149,63,0.3);
            padding: 15px; 
            border-radius: 12px; 
            margin: 20px 0; 
            text-align: right;
            font-size: 0.95rem; 
            color: #e2e8f0;
        }
        .legal-box li { 
            margin-bottom: 10px; 
            list-style: none; 
            position: relative; 
            padding-right: 20px; 
            font-size: 1rem;
        }
        .legal-box li::before { 
            content: '•'; 
            color: var(--gold-solid); 
            position: absolute; 
            right: 0; 
            font-weight: bold; 
            font-size: 1.2rem;
        }

        .warning-content .btn-gold {
            width: auto;
            padding: 12px 35px;
            font-size: 1.2rem;
            margin-top: 10px;
        }

        .info-grid {
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 15px; 
            margin: 25px 0;
        }
        .info-item {
            background: rgba(255,255,255,0.05); 
            padding: 12px; 
            border-radius: 10px; 
            border: 1px solid rgba(255,255,255,0.08);
        }
        .info-label { 
            display: block; 
            font-size: 0.85rem; 
            color: #a0aec0; 
            margin-bottom: 5px;
        }
        .info-value { 
            font-weight: bold; 
            color: #fff; 
            font-size: 1.1rem; 
        }

        .last-session-box {
            background: rgba(191, 149, 63, 0.15); 
            border-right: 5px solid var(--gold-solid);
            padding: 18px; 
            border-radius: 10px; 
            margin-top: 25px;
        }
        .last-session-box h5 {
            font-size: 1.2rem;
        }
        .last-session-box p {
            font-size: 1rem;
        }

        .modal-actions {
            display: flex; 
            gap: 12px; 
            justify-content: center; 
            margin-top: 25px; 
            border-top: 1px solid rgba(255,255,255,0.15); 
            padding-top: 20px;
        }
        .btn-action {
            flex: 1; 
            padding: 12px; 
            border-radius: 10px; 
            border: 1px solid transparent; 
            font-weight: bold; 
            font-size: 1rem; 
            cursor: pointer; 
            transition: 0.3s;
        }
        .btn-print { 
            border-color: var(--gold-solid); 
            color: var(--gold-solid); 
            background: transparent; 
        }
        .btn-print:hover { 
            background: var(--gold-solid); 
            color: #000; 
        }
        .btn-new { 
            background: #fff; 
            color: #000; 
        }
        .btn-exit { 
            background: #ef4444; 
            color: #fff; 
        }

        @media (max-width: 768px) {
            .info-grid { grid-template-columns: 1fr; }
            .search-card { padding: 30px 20px; }
            .search-card h1 { font-size: 2.2rem; }
        }
        
        @media print {
            body * { visibility: hidden; }
            #resultModal, #resultModal * { visibility: visible; }
            .modal-content { border: none !important; box-shadow: none !important; position: absolute; left: 0; top: 0; width: 100%; }
            .modal-actions, .btn-close { display: none !important; }
        }
    </style>
</head>
<body>

<!-- ========== الهيدر المطابق لصفحة تخصصاتنا ========== -->
<header class="fixed w-full z-[100] header-glass">
    <nav class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center" style="height: 100%;">
        <div class="flex items-center gap-4">
            <img src="logo.png" alt="شعار مؤسسة محمود عبد الحميد" class="w-20 h-20 object-contain">
            <div class="flex flex-col leading-tight">
                <h1 class="font-bold gold-text serif-font whitespace-nowrap" style="font-size: 28px !important; line-height: 1.3;">محمود عبد الحميد</h1>
                <p class="text-gray-300 font-medium" style="font-size: 13px !important; line-height: 1.2; letter-spacing: 0.5px;">المحامي بالنقض والدستورية العليا</p>
            </div>
        </div>
        <div class="hidden xl:flex items-center gap-6 font-bold text-sm">
            <a href="index.html" class="nav-link-gold">الرئيسية</a>
            <a href="about.html" class="nav-link-gold">عن المؤسسة</a>
            <a href="index.html#why-us" class="nav-link-gold">لماذا تختارنا</a>
            <a href="index.html#testimonials" class="nav-link-gold">آراء العملاء</a>
            <a href="specialties.html" class="nav-link-gold">تخصصاتنا</a>
            <a href="contact.html" class="nav-link-gold">تواصل معنا</a>
            <a href="blog.html" class="nav-link-gold">المدونة</a>
            
            <div class="nav-buttons flex items-center gap-2 mr-2">
                <a href="client-inquiry.html" class="track-case-btn px-3 py-2 rounded-lg text-xs flex items-center gap-2">
                    <i class="fas fa-gavel"></i> تابع قضيتك
                </a>
                <a href="contact.html?tab=visit" class="visit-btn px-3 py-2 rounded-lg text-xs">
                    حجز موعد
                </a>
                <a href="contact.html?tab=consult" class="gold-btn px-4 py-2 rounded-lg text-xs shadow-lg">طلب استشارة</a>
            </div>
        </div>
        <button id="menu-toggle" class="xl:hidden text-2xl gold-text">
            <i class="fas fa-bars-staggered"></i>
        </button>
    </nav>
</header>

<!-- القائمة الجانبية للموبايل - مطابقة لصفحة تخصصاتنا -->
<div id="mobile-menu" class="fixed inset-0 z-[110] p-8 lg:hidden flex flex-col justify-center">
    <button id="menu-close" class="absolute top-6 left-6 text-3xl gold-text">
        <i class="fas fa-times"></i>
    </button>
    <div class="flex flex-col gap-5 text-xl font-bold text-center">
        <a href="index.html" onclick="closeMenu()" class="nav-link-gold text-xl">الرئيسية</a>
        <a href="about.html" onclick="closeMenu()" class="nav-link-gold text-xl">عن المؤسسة</a>
        <a href="index.html#why-us" onclick="closeMenu()" class="nav-link-gold text-xl">لماذا تختارنا</a>
        <a href="index.html#testimonials" onclick="closeMenu()" class="nav-link-gold text-xl">آراء العملاء</a>
        <a href="specialties.html" onclick="closeMenu()" class="nav-link-gold text-xl">تخصصاتنا</a>
        <a href="contact.html" onclick="closeMenu()" class="nav-link-gold text-xl">تواصل معنا</a>
        <a href="blog.html" onclick="closeMenu()" class="nav-link-gold text-xl">المدونة</a>
        <div class="h-px bg-white/10 w-full my-4"></div>
        <a href="client-inquiry.html" onclick="closeMenu()" class="track-case-btn py-3 rounded-xl text-lg">
             تابع قضيتك
        </a>
        <a href="contact.html?tab=visit" onclick="closeMenu()" class="visit-btn py-3 rounded-xl text-lg">
             حجز موعد
        </a>
        <a href="contact.html?tab=consult" onclick="closeMenu()" class="gold-btn py-3 rounded-xl text-lg">
             طلب استشارة
        </a>
    </div>
</div>

<!-- ========== المحتوى الرئيسي ========== -->
<main class="main-container hidden" id="mainContent">
    <div class="search-card">
        <h1>استعلام القضايا</h1>
        <p>أدخل بيانات القضية للاطلاع على آخر المستجدات</p>

        <form id="searchForm" onsubmit="handleSearch(event)">
            <div class="input-group-custom">
                <input type="tel" id="phoneInput" class="form-control-custom" placeholder="رقم الهاتف" required>
                <span class="fixed-prefix">20</span>
            </div>
            <div class="input-group-custom">
                <input type="text" id="codeInput" class="form-control-custom" placeholder="كود القضية" required style="text-transform: uppercase;">
                <span class="fixed-prefix">MA-</span>
            </div>
            <button type="submit" class="btn-gold" id="searchBtn">
                <i class="bi bi-search"></i> الاطلاع
            </button>
        </form>
    </div>
</main>

<!-- الفوتير -->
<footer class="footer">
    جميع الحقوق محفوظة © 2024 مؤسسة محمود عبد الحميد للمحاماة
</footer>

<!-- مودال التحذير (مصغر) -->
<div class="modal fade" id="warningModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content glass-theme">
            <div class="warning-content">
                <i class="bi bi-shield-lock-fill" style="font-size: 3.5rem; color: var(--gold-solid);"></i>
                <h3 class="text-white amiri-font">تحذير قانوني</h3>
                <div class="legal-box">
                    <ul>
                        <li>هذا النظام مخصص فقط لعملاء المكتب المصرح لهم.</li>
                        <li>بيانات القضايا المعروضة سرية ومحمية قانونياً.</li>
                        <li>يتم تسجيل بيانات الدخول (IP) لأغراض الحماية.</li>
                        <li>الدخول غير المصرح به يعرضك للمساءلة القانونية.</li>
                    </ul>
                </div>
                <button class="btn-gold" onclick="acceptWarning()">
                    <i class="bi bi-check-circle-fill"></i> أوافق وأتابع
                </button>
            </div>
        </div>
    </div>
</div>

<!-- مودال النتيجة -->
<div class="modal fade" id="resultModal" data-bs-backdrop="static" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content glass-theme text-white">
            <div class="modal-body p-4">
                <div class="text-center border-bottom border-secondary border-opacity-25 pb-3 mb-3">
                    <h2 id="r_clientName" class="amiri-font" style="color: var(--gold-solid); font-size: 2.2rem;">-</h2>
                    <span id="r_clientRole" class="badge bg-light text-dark mt-2 px-3 py-1" style="font-size: 1rem;">-</span>
                </div>
                <div class="info-grid">
                    <div class="info-item"><span class="info-label">اسم الخصم</span><span class="info-value" id="r_opponent">-</span></div>
                    <div class="info-item"><span class="info-label">المحكمة</span><span class="info-value" id="r_court">-</span></div>
                    <div class="info-item"><span class="info-label">رقم القضية</span><span class="info-value" id="r_caseNum">-</span></div>
                    <div class="info-item"><span class="info-label">الدائرة</span><span class="info-value" id="r_circle">-</span></div>
                    <div class="info-item"><span class="info-label">موضوع الدعوى</span><span class="info-value" id="r_subject">-</span></div>
                    <div class="info-item"><span class="info-label">حالة القضية</span><span class="info-value text-warning" id="r_status">-</span></div>
                </div>
                <div class="last-session-box">
                    <h5 class="text-white mb-2"><i class="bi bi-clock-history text-warning"></i> آخر جلسة مسجلة</h5>
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span id="r_lastDate" style="color: var(--gold-solid); font-weight: bold; font-size: 1.1rem;">-</span>
                    </div>
                    <p id="r_lastDecision" class="mb-0 text-white-50" style="font-size: 1rem;">-</p>
                </div>
                <div class="modal-actions">
                    <button class="btn-action btn-print" onclick="window.print()"><i class="bi bi-printer"></i> طباعة</button>
                    <button class="btn-action btn-new" onclick="newSearch()"><i class="bi bi-search"></i> بحث جديد</button>
                    <button class="btn-action btn-exit" onclick="exitSystem()"><i class="bi bi-box-arrow-right"></i> خروج</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // إعدادات Supabase
    const SB_URL = "https://iyhfafodhptcdwrjywek.supabase.co";
    const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml5aGZhZm9kaHB0Y2R3cmp5d2VrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMzUzODYsImV4cCI6MjA4MjcxMTM4Nn0.YmeMSDkQ3Z_vpyMTyZ-3jbKLFzVZzwcLeDsdczrErHQ";
    const db = supabase.createClient(SB_URL, SB_KEY);
    
    let warningModal, resultModal;
    const mainContent = document.getElementById('mainContent');
    const phoneInput = document.getElementById('phoneInput');
    const codeInput = document.getElementById('codeInput');

    function removePrefix(input, prefix) {
        let value = input.value.trim();
        if (value.startsWith(prefix)) {
            input.value = value.substring(prefix.length).trim();
        }
    }

    phoneInput.addEventListener('input', function() {
        removePrefix(this, '20');
    });
    phoneInput.addEventListener('paste', function() {
        setTimeout(() => removePrefix(this, '20'), 10);
    });

    codeInput.addEventListener('input', function() {
        let val = this.value.trim().toUpperCase();
        if (val.startsWith('MA-')) {
            this.value = val.substring(3).trim();
        } else {
            this.value = val;
        }
    });
    codeInput.addEventListener('paste', function() {
        setTimeout(() => {
            let val = this.value.trim().toUpperCase();
            if (val.startsWith('MA-')) {
                this.value = val.substring(3).trim();
            } else {
                this.value = val;
            }
        }, 10);
    });

    document.addEventListener('DOMContentLoaded', () => {
        const warningEl = document.getElementById('warningModal');
        warningModal = new bootstrap.Modal(warningEl);
        
        const resultEl = document.getElementById('resultModal');
        resultModal = new bootstrap.Modal(resultEl);

        warningModal.show();
    });

    function acceptWarning() {
        warningModal.hide();
        mainContent.classList.remove('hidden');
    }

    async function handleSearch(e) {
        e.preventDefault();
        const btn = document.getElementById('searchBtn');
        const originalText = btn.innerHTML;
        
        let phoneVal = phoneInput.value.trim();
        let codeVal = codeInput.value.trim().toUpperCase();
        
        if (phoneVal.startsWith('20')) phoneVal = phoneVal.substring(2).trim();
        if (codeVal.startsWith('MA-')) codeVal = codeVal.substring(3).trim();

        if(!phoneVal || !codeVal) return;

        const fullPhone = "20" + phoneVal;
        const fullCode = "MA-" + codeVal;

        btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> جاري التحقق...';
        btn.disabled = true;

        try {
            const { data: cases, error } = await db
                .from('cases')
                .select('*')
                .eq('case_code', fullCode)
                .limit(1);

            if (error) throw error;
            
            const targetCase = cases.length > 0 ? cases[0] : null;

            if (!targetCase || !targetCase.client_phone.includes(fullPhone)) {
                throw new Error("NOT_FOUND");
            }

            const { data: sessions } = await db
                .from('sessions')
                .select('*')
                .eq('case_id', targetCase.id)
                .order('session_date', { ascending: false })
                .limit(1);

            const lastSession = sessions && sessions.length > 0 ? sessions[0] : null;

            showResult(targetCase, lastSession);

        } catch (err) {
            console.error(err);
            Swal.fire({
                icon: 'error',
                title: 'عذراً',
                text: 'بيانات الدخول غير صحيحة. يرجى التأكد من الكود ورقم الهاتف.',
                confirmButtonColor: '#bf953f',
                background: '#020617',
                color: '#fff'
            });
        } finally {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }
    }

    function showResult(c, s) {
        document.getElementById('r_clientName').innerText = c.client_name;
        document.getElementById('r_clientRole').innerText = c.client_role;
        document.getElementById('r_opponent').innerText = c.opponent_name || '-';
        document.getElementById('r_court').innerText = c.court_name;
        document.getElementById('r_caseNum').innerText = c.case_number + ' / ' + c.case_year;
        document.getElementById('r_circle').innerText = c.circle || '-';
        document.getElementById('r_subject').innerText = c.case_subject || 'غير محدد';
        
        if (s) {
            document.getElementById('r_status').innerText = s.case_status;
            const d = new Date(s.session_date);
            document.getElementById('r_lastDate').innerText = d.toLocaleDateString('ar-EG', {weekday:'long', year:'numeric', month:'long', day:'numeric'});
            document.getElementById('r_lastDecision').innerText = s.decision || 'لم يسجل قرار';
        } else {
            document.getElementById('r_status').innerText = 'جديدة';
            document.getElementById('r_lastDate').innerText = 'لا توجد جلسات مسجلة';
            document.getElementById('r_lastDecision').innerText = '';
        }

        resultModal.show();
    }

    function newSearch() {
        resultModal.hide();
        document.getElementById('searchForm').reset();
        phoneInput.value = '';
        codeInput.value = '';
    }

    function exitSystem() {
        resultModal.hide();
        Swal.fire({
            icon: 'success',
            title: 'شكراً لك',
            text: 'شكراً لاستخدامكم نظام الاستعلام الإلكتروني لمؤسسة محمود عبد الحميد.',
            background: '#020617',
            color: '#fff',
            confirmButtonColor: '#bf953f',
            confirmButtonText: 'إغلاق',
            timer: 3000
        }).then(() => {
            window.location.href = "https://almostshar.vercel.app/index.html";
        });
    }

    // قائمة الموبايل - نفس وظائف الصفحات الأخرى
    const mobileMenu = document.getElementById('mobile-menu');
    const menuToggle = document.getElementById('menu-toggle');
    const menuClose = document.getElementById('menu-close');
    
    function closeMenu() {
        if(mobileMenu) {
            mobileMenu.classList.remove('active');
            document.body.style.overflow = '';
        }
    }
    
    if (menuToggle) {
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
    }
    
    if (menuClose) {
        menuClose.addEventListener('click', closeMenu);
    }
    
    document.querySelectorAll('#mobile-menu a').forEach(link => {
        link.addEventListener('click', closeMenu);
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
